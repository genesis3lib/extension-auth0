"""
Auth0 authentication settings for {{projectName}}.
Import these settings into your environment-specific settings files.
"""

import os

# Auth0 Configuration
AUTH0_DOMAIN = os.environ.get('AUTH0_DOMAIN', '')
AUTH0_AUDIENCE = os.environ.get('AUTH0_AUDIENCE', '')
AUTH0_ROLE_CLAIM_KEY = '{{{roleClaimKey}}}'

# REST Framework Authentication Configuration for Auth0
REST_FRAMEWORK_AUTH0 = {
    'DEFAULT_AUTHENTICATION_CLASSES': [
        'auth.authentication.Auth0JSONWebTokenAuthentication',
    ],
    'DEFAULT_PERMISSION_CLASSES': [
        'rest_framework.permissions.IsAuthenticated',
    ],
}

# Merge AUTH0 settings into REST_FRAMEWORK if enabled
def apply_auth0_settings(rest_framework_settings):
    """
    Call this in your settings to apply Auth0 authentication.

    Usage in dev.py or prod.py:
        from .base import REST_FRAMEWORK
        from .auth0 import apply_auth0_settings
        REST_FRAMEWORK = apply_auth0_settings(REST_FRAMEWORK)
    """
    updated = rest_framework_settings.copy()
    updated['DEFAULT_AUTHENTICATION_CLASSES'] = REST_FRAMEWORK_AUTH0['DEFAULT_AUTHENTICATION_CLASSES']
    updated['DEFAULT_PERMISSION_CLASSES'] = REST_FRAMEWORK_AUTH0['DEFAULT_PERMISSION_CLASSES']
    return updated

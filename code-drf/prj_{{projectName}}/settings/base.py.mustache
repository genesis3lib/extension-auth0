# Auth0 extension: Configure authentication
# This appends to base.py settings

# Override REST Framework authentication settings
REST_FRAMEWORK['DEFAULT_AUTHENTICATION_CLASSES'] = [
    'auth.authentication.Auth0JSONWebTokenAuthentication',
]
REST_FRAMEWORK['DEFAULT_PERMISSION_CLASSES'] = [
    'rest_framework.permissions.IsAuthenticated',
]

# Auth0 Configuration
# Non-confidential values baked in at generation time (same as Spring)
AUTH0_DOMAIN = '{{{auth0Domain}}}'
AUTH0_ISSUER = 'https://{{{auth0Domain}}}/'
AUTH0_JWKS_URI = 'https://{{{auth0Domain}}}/.well-known/jwks.json'
AUTH0_ROLE_CLAIM_KEY = '{{{roleClaimKey}}}'
{{#tenantIdClaimKey}}
AUTH0_TENANT_CLAIM_KEY = '{{{tenantIdClaimKey}}}'
{{/tenantIdClaimKey}}
{{^tenantIdClaimKey}}
AUTH0_TENANT_CLAIM_KEY = ''
{{/tenantIdClaimKey}}

# Audience varies per environment - read from env var with fallback
AUTH0_AUDIENCE = os.environ.get('PYTHON_DRF_AUTH0_AUDIENCE', 'https://{{projectName}}-api.{{domain}}/api/v1/')
